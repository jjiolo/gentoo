#!/usr/bin/sh -l
#############
umask 0007
#############
print(){

 printf "%s\n" "#############"
 printf "%s\n" "# ${1}"
 printf "%s\n" "#############"

}
#############
print system.mount ; . /etc/self/b.init/system.mount
print system.dev   ; . /etc/self/b.init/system.dev
print system.proc  ; . /etc/self/b.init/system.proc
print system.sys   ; . /etc/self/b.init/system.sys
print system.tmp   ; . /etc/self/b.init/system.tmp
#############
print system.log  ; . /etc/self/b.init/system.log
print system.lock ; . /etc/self/b.init/system.lock
#############
print sysctl ; sysctl -p /etc/sysctl.conf &>/dev/null
#############
print storage.mount  ; . /etc/self/b.init/storage.mount
print storage.setup  ; . /etc/self/b.init/storage.setup
print storage.shared ; . /etc/self/b.init/storage.shared
#############
print system.network ; . /etc/self/b.init/system.network
#############

[ "$(hostname)" == "server" ] && . /etc/self/z.test/b.server start
[ "$(hostname)" == "server" ] && . /etc/self/z.test/b.client start

#############

[ "$(hostname)" == "virtual" ] && { brctl delif lan eth0 ; brctl addif nat eth0 ; }
[ "$(hostname)" == "virtual" ] && { echo yes | ash /etc/self/e.setpriv/setpriv_network_default nat virtual ; }
[ "$(hostname)" == "virtual" ] && { echo yes | ash /etc/self/e.setpriv/setpriv_network_zcip nat ; }
[ "$(hostname)" == "virtual" ] && { . /etc/self/z.test/b.client start ; }

#############
[ -f "${storage}/.init" ] && . "${storage}/.init" ; clear
#############

