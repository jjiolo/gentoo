
#
table inet filter
chain inet filter ilan
chain inet filter olan
flush chain inet filter ilan
flush chain inet filter olan
#############
table inet filter {

 chain ilan {

  # server

  udp dport {51820} ct state new log flags skuid prefix "input.lan.new " accept # vpnd

















  # icmp

  ip protocol {icmp}   log flags skuid prefix "input.lan.icmp " accept # icmp
  ip6 nexthdr {icmpv6} log flags skuid prefix "input.lan.icmp " accept # icmp

  # igmp

  ip protocol {igmp} log flags skuid prefix "input.lan.igmp " accept # igmp

  # drop

  ct state invalid log flags skuid prefix "input.lan.invalid " drop
                   log flags skuid prefix "input.lan.drop " drop

 }

}
#############
table inet filter {

 chain olan {

  # client

  udp dport {51820} udp sport {51820} ct state new log flags skuid prefix "output.lan.new " accept # vpnd

  udp dport {53,123} skuid {ntpd} ct state new log flags skuid prefix "output.lan.new " accept # ntpc

  ip protocol {tcp} skuid {ddns} ct state new log flags skuid prefix "output.lan.new " accept # tord
  ip protocol {tcp} skuid {dnsd} ct state new log flags skuid prefix "output.lan.new " accept # tord

  ip protocol {udp} skuid {p2pd} ct state new log flags skuid prefix "output.lan.new " accept # p2pd
  ip protocol {tcp} skuid {p2pd} ct state new log flags skuid prefix "output.lan.new " accept # p2pd














  udp dport {53} skuid {root,250} ct state new log flags skuid prefix "output.lan.new " accept # stage3
  tcp dport {443} skuid {root,250} ct state new log flags skuid prefix "output.lan.new " accept # stage3

  tcp dport {6697}    skuid {nobody} ct state new log flags skuid prefix "output.lan.new " accept # ircd
  tcp dport {22}      skuid {nobody} ct state new log flags skuid prefix "output.lan.new " accept # sshd
  tcp dport {465,995} skuid {nobody} ct state new log flags skuid prefix "output.lan.new " accept # maild
  tcp dport {443}     skuid {nobody} ct state new log flags skuid prefix "output.lan.new " accept # httpd

  tcp dport {6697}    skuid {irc}  ct state new log flags skuid prefix "output.lan.new " accept # ircd
  tcp dport {22}      skuid {ssh}  ct state new log flags skuid prefix "output.lan.new " accept # sshd
  tcp dport {465,995} skuid {mail} ct state new log flags skuid prefix "output.lan.new " accept # maild
  tcp dport {443}     skuid {http} ct state new log flags skuid prefix "output.lan.new " accept # httpd

  # icmp

  ip protocol {icmp}   log flags skuid prefix "output.lan.icmp " accept # icmp
  ip6 nexthdr {icmpv6} log flags skuid prefix "output.lan.icmp " accept # icmp

  # igmp

  ip protocol {igmp} log flags skuid prefix "output.lan.igmp " accept # igmp

  # drop

  ct state invalid log flags skuid prefix "output.lan.invalid " drop
                   log flags skuid prefix "output.lan.drop " drop

 }

}
#############

